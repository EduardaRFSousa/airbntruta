<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>AirBnTruta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #121212;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        .container-login {
            width: 380px;
            padding: 30px;
            background: #1e1e1e;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        }

        .form-label { color: #aaa; font-size: 0.9rem; }
        .btn-primary-custom { background: #ff4757; border: none; color: #fff; width: 100%; padding: 10px; border-radius: 5px; transition: 0.3s; }
        .btn-primary-custom:hover { background: #ff6b81; }
        .erro { color: #ff6b6b; margin-top: 15px; text-align: center; font-size: 0.9rem; }
        hr { border-color: #444; }
        
        .modal-body .form-control, .modal-body .form-select {
            display: block;
            width: 100%;
        }
        ::placeholder {
            color: #6c757d !important; /* Cor cinza clara do Bootstrap */
            opacity: 1; /* Garante que a opacidade não esconda o texto */
        }

        /* Caso queira um ajuste específico para os inputs escuros do modal */
        .form-control::placeholder {
            color: #adb5bd !important;
        }
    </style>
</head>
<body>

<div class="container-login">
    <h2 class="text-center mb-4">AirBnTruta</h2>
    
    <form id="formLogin" method="post" onsubmit="direcionarLogin(event)">
        <div class="mb-3">
            <label class="form-label">Vulgo</label>
            <input type="text" name="vulgo" class="form-control bg-dark text-white border-secondary" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Senha</label>
            <input type="password" name="senha" class="form-control bg-dark text-white border-secondary" required>
        </div>

        <div class="mb-4">
            <label class="form-label">Tipo de usuário</label>
            <select id="tipoUsuario" name="tipoUsuario" class="form-select bg-dark text-white border-secondary">
                <option value="FUGITIVO">Fugitivo</option>
                <option value="HOSPEDEIRO">Hospedeiro</option>
            </select>
        </div>

        <button type="submit" class="btn-primary-custom">Entrar</button>

        <div class="erro" th:if="${msg}">
            <span th:text="${msg}"></span>
        </div>
    </form>

    <hr class="my-4">

    <p class="text-center text-secondary">Não tem conta?</p>
    <button type="button" class="btn btn-outline-light w-100" data-bs-toggle="modal" data-bs-target="#modalRegistro">
        Criar conta agora
    </button>
</div>

<div class="modal fade" id="modalRegistro" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark text-light border-secondary">
            <div class="modal-header border-secondary">
                <h5 class="modal-title">Criar nova conta</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-4">
                    <label class="form-label">Você é um...</label>
                    <select id="tipoCadastro" class="form-select bg-dark text-white border-secondary" onchange="trocarFormulario()">
                        <option value="FUGITIVO">Fugitivo (Procurando abrigo)</option>
                        <option value="HOSPEDEIRO">Hospedeiro (Oferecendo abrigo)</option>
                    </select>
                </div>

                <form id="formFugitivo" th:action="@{/fugitivo/registrar}" method="post">
                    <div class="mb-2"><input class="form-control bg-dark text-white border-secondary" name="nome" placeholder="Nome completo" required></div>
                    <div class="mb-2"><input class="form-control bg-dark text-white border-secondary" name="vulgo" placeholder="Seu Vulgo" required></div>
                    <div class="mb-2"><input class="form-control bg-dark text-white border-secondary" name="especialidade" placeholder="Especialidade (Ex: Hacker)"></div>
                    <div class="mb-2"><input class="form-control bg-dark text-white border-secondary" name="faccao" placeholder="Sua Facção"></div>
                    <div class="mb-2"><textarea class="form-control bg-dark text-white border-secondary" name="descricao" placeholder="Sua descrição..."></textarea></div>
                    <div class="mb-3"><input type="password" class="form-control bg-dark text-white border-secondary" name="senha" placeholder="Senha segura" required></div>
                    <button type="submit" class="btn btn-danger w-100">Registrar como Fugitivo</button>
                </form>

                <form id="formHospedeiro" th:action="@{/hospedeiro/save}" method="post" style="display:none">
                    <div class="mb-2"><input class="form-control bg-dark text-white border-secondary" name="nome" placeholder="Nome completo" required></div>
                    <div class="mb-2"><input class="form-control bg-dark text-white border-secondary" name="vulgo" placeholder="Seu Vulgo" required></div>
                    <div class="mb-2"><input class="form-control bg-dark text-white border-secondary" name="contato" placeholder="Contato seguro"></div>
                    <div class="mb-3"><input type="password" class="form-control bg-dark text-white border-secondary" name="senha" placeholder="Senha" required></div>
                    <button type="submit" class="btn btn-warning w-100">Registrar como Hospedeiro</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // TODO: Fazer lógica de mensagem de erros na hora de fazer Login/Registro
    function trocarFormulario() {
        const tipo = document.getElementById("tipoCadastro").value;
        const formF = document.getElementById("formFugitivo");
        const formH = document.getElementById("formHospedeiro");
        
        formF.style.display = (tipo === "FUGITIVO") ? "block" : "none";
        formH.style.display = (tipo === "HOSPEDEIRO") ? "block" : "none";
    }

    function direcionarLogin(event) {
        event.preventDefault();
        const tipo = document.getElementById("tipoUsuario").value;
        const form = document.getElementById("formLogin");

        if (tipo === "FUGITIVO") {
            form.action = "/fugitivo/login";
        } else {
            form.action = "/hospedeiro/login";
        }

        form.submit();
    }

</script>

</body>
</html>